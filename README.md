# HW4 Auth API

## Как запустить


1. В корне проекта выполните:

```bash
docker-compose up --build
```

2. API будет доступен по адресу: http://localhost:8080
3. Swagger UI: http://localhost:8080/swagger-ui/index.html#

## Основной функционал
- Регистрация и аутентификация пользователей
- JWT-токены для доступа к защищённым ресурсам
- Refresh-токены для обновления access-токена
- Роли пользователей и разграничение доступа
- Swagger-документация

## Идея и архиткутра

### Модель аутентификации и авторизации

Система использует JWT (JSON Web Token) с двумя типами токенов:
- **Access Token**: короткоживущий токен (15 минут) для доступа к защищенным ресурсам
- **Refresh Token**: долгоживущий токен (7 дней) для обновления Access Token

### Безопасность токенов

Для повышения безопасности токены:
- Шифруются с использованием алгоритма AES-GCM
- Привязываются к:
  - IP-адресу пользователя
  - User-Agent браузера
  - X-Fingerprint (идентификатор устройства/сессии)

### Процесс проверки токена

При каждом запросе к защищенному ресурсу:
1. Извлекается токен из заголовка Authorization
2. Токен расшифровывается
3. Проверяется, что токен существует в базе и не отозван(white list)
4. Проверяется срок действия токена
5. Проверяется соответствие IP, User-Agent и X-Fingerprint
6. Загружается пользователь и его роли
7. Создается объект аутентификации Spring Security

### Начальная настройка

При первом запуске приложения автоматически создаются:
- Роли ADMIN и USER
- Административный пользователь (логин и пароль по умолчанию: admin/admin)
---

## Личные комментрии
Исходя из лекции было понятно как стоит сделать, но  мне стало интересно сделать
решение корректным исходя уже из текущей ситуации, которую я сам же и создал. 
В целом всё преимущество JWT тут потеряно, т.к мне приходится хранить состояние
в white list. Ну и дебажить это чудо тоже очень грустное занятие. Всё таки использовать обычный
JWE тут сильно правильней, но я сделал некое его подобие.
---
Хорошего дня еще раз :)
